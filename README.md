# ğŸ¨ Colorizer â€“ Grayscale Image Colorization Web App

Colorizer is a **Flask-based web application** that automatically colorizes grayscale images using a **deep learning U-Net model** trained in **LAB color space**. Users can upload a black-and-white image through a web interface and instantly receive a colorized version generated by the model.

This project demonstrates how to colorize grayscale images using a U-Net architecture, where the model predicts the **`a` and `b` color channels** from the grayscale **`L` channel**, producing a fully colorized image.

---

## ğŸ“Œ Project Overview

The U-Net-based colorizer takes a grayscale image as input and generates a colorized version using the LAB color space:

* **L channel** â€“ Lightness (grayscale information)
* **a & b channels** â€“ Color information

The trained network predicts the `ab` channels, which are combined with the original `L` channel to reconstruct the final RGB image.

---

## ğŸŒ Web App Overview

* Upload grayscale images via a browser
* Flask backend handles preprocessing and inference
* Deep learning model predicts color information
* Colorized image is displayed and available for download

---

##  Features

*  Simple web interface for image upload
*  U-Net deep learning architecture
*  LAB color space based image processing
*  Fast inference using PyTorch
*  Supports JPG, JPEG, PNG image formats

---

##  Tech Stack

### Backend

* Python
* Flask
* PyTorch
* OpenCV
* NumPy

### Frontend

* HTML
* CSS
* Jinja2 Templates

---

##  Requirements

The following Python libraries are required to run the project:

* Python 3.6+
* PyTorch
* OpenCV
* NumPy
* Matplotlib
* tqdm

Install dependencies using:

```bash
pip install -r requirements.txt
```

### requirements.txt

```txt
torch>=1.7.1
opencv-python
numpy
matplotlib
tqdm
```

---

##  Directory Structure

```
Colorizer/
â”œâ”€â”€ Dataset/
â”‚   â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ preprocessedimg/
â”‚   â”‚   â”œâ”€â”€ AB/
â”‚   â”‚   â””â”€â”€ L/
â”‚   â””â”€â”€ split/
â”‚       â”œâ”€â”€ train/
â”‚       â”œâ”€â”€ val/
â”‚       â””â”€â”€ test/
â”‚
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ checkpoints/
â”‚   â”‚   â””â”€â”€ best_model.pth
â”‚   â””â”€â”€ test_results/
â”‚
â”œâ”€â”€ source/
â”‚   â”œâ”€â”€ preprocess.py
â”‚   â”œâ”€â”€ splitdata.py
â”‚   â”œâ”€â”€ train.py
â”‚   â””â”€â”€ usemodel.py
â”‚
â”œâ”€â”€ static/
â”‚   â”œâ”€â”€ uploads/
â”‚   â””â”€â”€ results/
â”‚
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ index.html
â”‚
â”œâ”€â”€ app.py
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

---

##  Model Description

The model is based on the **U-Net architecture**, widely used for image-to-image tasks:

* **Encoder:** Extracts features and downsamples the input image
* **Bottleneck:** Learns high-level representations
* **Decoder:** Upsamples the image using skip connections

The model outputs the **`ab` channels**, predicted from the grayscale **`L` channel**.

---

## ğŸš€ Installation & Setup

### 1ï¸âƒ£ Clone the Repository

```bash
git clone https://github.com/ParthLathiya/Colorizer.git
cd Colorizer
```

---

### 2ï¸âƒ£ Install Dependencies

```bash
pip install -r requirements.txt
```

---

### 3ï¸âƒ£ Add Trained Model

Place the trained model file here:

```
models/checkpoints/best_model.pth
```

---

### 4ï¸âƒ£ Run the Flask App

```bash
python app.py
```

---

### 5ï¸âƒ£ Open in Browser

```
http://127.0.0.1:5000/
```

---

## ğŸ–¼ï¸ Usage

### Web Application

1. Open the web app in your browser
2. Upload a grayscale image
3. Click **Colorize**
4. View and download the colorized image

---

### Colorize a Single Image (Script)

```python
colorize_and_display('path/to/grayscale_image.jpg')
```

---

### Colorize Images from a Directory

```python
model_path = 'path/to/model/checkpoint.pth'
input_path = 'path/to/input/images'
output_path = 'path/to/output/directory'
```

All colorized images will be saved to the output directory.

---

##  Model Training (Optional)

To train the model from scratch:

```bash
python source/train.py
```

* Training uses LAB color space
* Model checkpoints are saved in `models/checkpoints/`

---

##  Results

The model produces realistic colorization results depending on dataset quality. Sample outputs can be found in:

```
models/test_results/
```

---

## ğŸ“ Notes

* Input images are assumed to be grayscale
* Images are resized to **256Ã—256** before inference

---

## ğŸ¤ Contributing

Contributions are welcome!

* Fork the repository
* Create a new branch
* Commit your changes
* Open a pull request

---

##  License

This project is licensed under the **MIT License**.

---

##  Author

**Parth Lathiya**
Deep Learning | Computer Vision | Flask
ğŸ”— GitHub: [https://github.com/ParthLathiya](https://github.com/ParthLathiya)

---

â­ If you find this project useful, please consider giving it a star!
